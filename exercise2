create database InventoryManagement;
use InventoryManagement;

create table products (
	productID int primary key not null auto_increment,
    productName varchar(100),
    quantity int 
);

create table inventoryChanges (
	changeID int primary key not null auto_increment,
    productID int not null,
    oldQuantity int,
    newQuantity int,
    changeDate datetime,
    foreign key (productID) references products (productID)
);

INSERT INTO products (productName, quantity) VALUES
('Chuột không dây Logitech', 50),
('Bàn phím cơ AKKO 3098', 35),
('Tai nghe gaming HyperX', 20),
('Màn hình Samsung 27 inch', 15),
('Laptop Dell Inspiron', 10);

DELIMITER $$ 
create trigger BeforeProductDelete
before 	delete on products
for each row 
begin 
	if OLD.quantity > 10 then
    signal sqlstate '45000'
    set message_text = 'Không thể xoá sản phẩm có số lượng lớn hơn 10';
    end if;
    end $$ 
    DELIMITER ;

DELETE FROM products WHERE productID = 1;

